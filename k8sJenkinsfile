#!/usr/bin/env groovy
// pipeline {
//     agent {
//         kubernetes {
//             containerTemplate {
//                 name 'helm'
//                 image 'lachlanevenson/k8s-helm:v3.1.1'
//                 ttyEnabled true
//                 command 'cat'
//             }
//         }
//     }

//     stages {
//         stage('Deploy Streaming') {
//             steps {
//                 container('helm') { 
//                     sh "helm version"
//                 } 
//             }
//         }
//     }
// }

podTemplate(containers: [
    containerTemplate(name: 'k8s-helm', image: 'lachlanevenson/k8s-helm:latest', command: 'sleep', args: '99d'),
  ]) {

    node(POD_LABEL) {
        stage('Helm slave test') {
            container('k8s-helm') {
                stage('Helm Version') {
                    sh 'helm version'
                }
            }
        }
    }
}